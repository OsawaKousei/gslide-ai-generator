# Google Slides Template Specifications

本アプリケーション (`GSlide-AI-Generator`) がスライド生成を行うためには、**マスターテンプレート**となる Google スライドファイルが必要です。
AI は視覚的なデザインを行わず、このテンプレートファイル内のスライドをコピー（複製）し、テキストを置換することでプレゼンテーションを構築します。

## 1. テンプレートファイルの要件

### 1.1 基本要件

- **フォーマット:** Google Slides 形式。
- **権限:** アプリケーションを実行するユーザーが、「閲覧」または「編集」権限を持っていること。
- **格納場所:** Google Drive 上（共有ドライブ可）。

### 1.2 スライド構成 (Page IDs)

テンプレートファイル内の各スライドには、AI が指定する `templateId` と対応する **Page ID (ObjectId)** が設定されていることが望ましいです。
ただし、Google Slides UI から直接 Page ID を変更することはできないため、本 PoC では**スライドの並び順（インデックス）**、または**Layout名**によってマッピングを行います。

#### 推奨構成 (Convention)

テンプレートファイルの先頭から順に以下のレイアウトとして扱います。

1. **Page 1 (Index 0):** `layout_title` (タイトルスライド)
2. **Page 2 (Index 1):** `layout_bullet` (箇条書きコンテンツ)
3. **Page 3 (Index 2):** `layout_comparison` (比較・2カラム)
4. **Page 4 (Index 3):** `layout_content` (汎用コンテンツ)

> **Note:** アプリケーション実装時は、`templateId` 文字列と、テンプレートプレゼンテーション内の「対応するスライドの Object ID」をマッピングするロジックが必要です。現状の実装では簡易的に「1枚目を複製」していますが、将来的にはこの順序規約に基づいて複製元を選択します。

### 1.3 プレースホルダー規約

各スライド内のテキストボックスには、以下の置換用変数を記述しておきます。
AI はこれらの文字列を検索し、生成されたテキストに置換します。
書式維持 (Match Case) のため、かっこ `{{ }}` で囲むことを推奨します。

- `{{title}}`: スライドのタイトル
- `{{subTitle}}`: サブタイトル（タイトルスライド用）
- `{{body}}`: 本文、箇条書き
- `{{footer}}`: フッター（日付、社外秘表示など）

---

## 2. アプリケーションでの利用フロー

1. **準備:** ユーザーは上記の要件を満たす `.pptx` をアップロードするか、Google Slides を新規作成してテンプレートを用意する。
2. **設定:** アプリ右上の設定 (Config) アイコンをクリック。
3. **選択:** "Select Template" ボタンを押し、Google Drive Picker から上記ファイルを選択する。
4. **保存:** ファイル ID がアプリケーションに保存され、以後の生成はこのファイルを親として行われる。

## 3. Google Picker API 設定 (開発者向け)

テンプレート選択機能を利用するには、Google Cloud Console での設定が必要です。

1. **Enable API:** "Google Picker API" を有効にする。
2. **Credentials:**
   - **API Key:** ブラウザ制限 (HTTP Referrer) を設定した API Key を発行し、`.env` の `VITE_GOOGLE_API_KEY` に設定する。
   - **Client ID:** `VITE_GOOGLE_CLIENT_ID` (既存)。
