# Google Slides Template Specifications

本アプリケーション (`GSlide-AI-Generator`) がスライド生成を行うためには、**マスターテンプレート**となる Google スライドファイルが必要です。
AI は視覚的なデザインを行わず、このテンプレートファイル内のスライドをコピー（複製）し、テキストを置換することでプレゼンテーションを構築します。

## 1. テンプレートファイルの要件

### 1.1 基本要件

- **フォーマット:** Google Slides 形式。
- **権限:** アプリケーションを実行するユーザーが、「閲覧」または「編集」権限を持っていること。
- **格納場所:** Google Drive 上（共有ドライブ可）。

### 1.2 スライド構成 (Page IDs)

テンプレートファイル内の各スライドには、AI が指定する `templateId` と対応する **Page ID (ObjectId)** が設定されていることが望ましいです。
ただし、Google Slides UI から直接 Page ID を変更することはできないため、本 PoC では**スライドの並び順（インデックス）**、または**Layout名**によってマッピングを行います。

#### 推奨構成 (Convention)

テンプレートファイルの先頭から順に以下のレイアウトとして扱います。

1. **Page 1 (Index 0):** `layout_title` (タイトルスライド)
2. **Page 2 (Index 1):** `layout_bullet` (箇条書きコンテンツ)
3. **Page 3 (Index 2):** `layout_comparison` (比較・2カラム)
4. **Page 4 (Index 3):** `layout_content` (汎用コンテンツ)

> **Note:** アプリケーション実装時は、`templateId` 文字列と、テンプレートプレゼンテーション内の「対応するスライドの Object ID」をマッピングするロジックが必要です。現状の実装では簡易的に「1枚目を複製」していますが、将来的にはこの順序規約に基づいて複製元を選択します。

### 1.3 プレースホルダー規約

各スライド内のテキストボックスには、以下の置換用変数を記述しておきます。
AI はこれらの文字列を検索し、生成されたテキストに置換します。
書式維持 (Match Case) のため、かっこ `{{ }}` で囲むことを推奨します。

- `{{title}}`: スライドのタイトル
- `{{subTitle}}`: サブタイトル（タイトルスライド用）
- `{{body}}`: 本文、箇条書き
- `{{footer}}`: フッター（日付、社外秘表示など）

---

## 2. アプリケーションでの利用フロー

1. **準備:** ユーザーはテンプレートとなる `.pptx` ファイルをローカルに用意する。
2. **アップロード:** アプリにログインすると、右上に "Upload Template" ボタンが表示される（または設定メニュー内）。
3. **実行:** ボタンを押し、PC 上の `.pptx` ファイルを選択する。
4. **保存:** ファイルが Google Drive へアップロードされ、そのファイル ID がテンプレートとして使用される。

> **Note:** セキュリティ権限 (`drive.file`) の制約上、アプリは自身が作成（アップロード）したファイルのみにアクセス可能です。そのため、既存の Drive ファイルを選択するのではなく、都度（または初回に）テンプレートをアップロードする方式を採用しています。
